<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f0f0f5; margin: 0; padding: 0; color: #1a1a1a;">
<div style="max-width: 640px; margin: 0 auto; background: #fff;">

  <!-- Header -->
  <div style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); color: #fff; padding: 48px 32px; text-align: center;">
    <h1 style="margin: 0; font-size: 32px; font-weight: 700; letter-spacing: -0.5px;">Your Daily Briefing</h1>
    <div style="margin-top: 12px; font-size: 20px; font-weight: 500; opacity: 0.95;">{{ date }}</div>
  </div>

  <!-- Weather -->
  <div style="padding: 32px 28px 24px 28px;">
    <div style="font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; color: #2b7de9; margin: 0 0 16px 0;">&#9728;&#65039; Weather in NYC</div>
    <div style="background: #e8f4fd; border-radius: 12px; padding: 24px; text-align: center; border: 1px solid #d0e8f7;">
      <div style="font-size: 52px; font-weight: 700; color: #1a1a2e; line-height: 1;">{{ weather.current_temp }}&deg;{{ weather.unit }}</div>
      <div style="font-size: 16px; color: #444; margin: 6px 0;">{{ weather.conditions }}</div>
      <div style="font-size: 14px; color: #6a9ec7;">H: {{ weather.high }}&deg; &nbsp;&bull;&nbsp; L: {{ weather.low }}&deg;</div>
      <div style="font-size: 13px; color: #555; margin-top: 14px; line-height: 1.6; text-align: left; background: rgba(255,255,255,0.6); border-radius: 8px; padding: 12px 14px;">{{ weather.forecast }}</div>
    </div>
    {% if weather.hourly %}
    <table style="width: 100%; border-collapse: collapse; margin-top: 16px; font-size: 13px; color: #1a1a2e;">
      <tr style="border-bottom: 2px solid #d0e8f7;">
        <th style="text-align: left; padding: 8px 6px; color: #2b7de9; font-weight: 700;">Time</th>
        <th style="text-align: center; padding: 8px 6px; color: #2b7de9; font-weight: 700;">Temp</th>
        <th style="text-align: left; padding: 8px 6px; color: #2b7de9; font-weight: 700;">Conditions</th>
        <th style="text-align: center; padding: 8px 6px; color: #2b7de9; font-weight: 700;">Precip</th>
        <th style="text-align: center; padding: 8px 6px; color: #2b7de9; font-weight: 700;">Humidity</th>
        <th style="text-align: center; padding: 8px 6px; color: #2b7de9; font-weight: 700;">Wind</th>
      </tr>
      {% for h in weather.hourly %}
      <tr style="border-bottom: 1px solid #e8f4fd;">
        <td style="padding: 8px 6px; font-weight: 600;">{{ h.label }}</td>
        <td style="padding: 8px 6px; text-align: center; font-weight: 700;">{{ h.temp }}&deg;F</td>
        <td style="padding: 8px 6px; color: #555;">{{ h.conditions }}</td>
        <td style="padding: 8px 6px; text-align: center;">{{ h.precip_chance }}</td>
        <td style="padding: 8px 6px; text-align: center;">{{ h.humidity }}</td>
        <td style="padding: 8px 6px; text-align: center; color: #555;">{{ h.wind }}</td>
      </tr>
      {% endfor %}
    </table>
    {% endif %}
  </div>

  <!-- Divider -->
  <div style="padding: 0 28px;"><div style="height: 2px; background: linear-gradient(to right, #f59e42, #fbbf24, #f59e42); border-radius: 2px;"></div></div>

  <!-- Top News -->
  <div style="padding: 28px 28px 24px 28px;">
    <div style="font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; color: #d97706; margin: 0 0 20px 0;">&#128240; Top News</div>
    {% for story in news %}
    <div style="background: #fff; border: 1px solid #eee; border-radius: 10px; padding: 20px; margin-bottom: 14px; border-left: 4px solid #f59e42;">
      <!-- Date -->
      <div style="font-size: 12px; font-weight: 600; color: #b45309; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px;">{% if story.published %}{{ story.published }}{% else %}Today{% endif %}{% if story.source %} &nbsp;&middot;&nbsp; <span style="display: inline-block; background: #fef3c7; color: #92400e; font-size: 11px; font-weight: 600; padding: 2px 8px; border-radius: 10px;">{{ story.source }}</span>{% endif %}</div>
      <!-- Title -->
      <a href="{{ story.link }}" style="color: #1a1a2e; text-decoration: none; font-size: 17px; font-weight: 700; line-height: 1.35; display: block;">{{ story.title }}</a>
      <!-- Summary -->
      {% if story.summary %}
        <div style="font-size: 14px; color: #555; line-height: 1.6; margin-top: 12px; padding: 0 2px;">{{ story.summary | safe }}</div>
      {% endif %}
    </div>
    {% endfor %}
    {% if not news %}<div style="font-size: 14px; color: #888; font-style: italic;">No news available today.</div>{% endif %}
  </div>

  <!-- Divider -->
  <div style="padding: 0 28px;"><div style="height: 2px; background: linear-gradient(to right, #a855f7, #c084fc, #a855f7); border-radius: 2px;"></div></div>

  <!-- Podcasts -->
  <div style="padding: 28px 28px 24px 28px;">
    <div style="font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; color: #8b5cf6; margin: 0 0 20px 0;">&#127897;&#65039; Podcast Episodes</div>
    {% for ep in podcasts %}
    <div style="background: #fff; border: 1px solid #eee; border-radius: 10px; padding: 20px; margin-bottom: 14px; border-left: 4px solid #a855f7;">
      <!-- Date + Podcast name -->
      <div style="font-size: 12px; font-weight: 600; color: #7c3aed; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px;">{{ ep.published }} &nbsp;&middot;&nbsp; {{ ep.podcast }}</div>
      <!-- Title -->
      <a href="{{ ep.link }}" style="color: #1a1a2e; text-decoration: none; font-size: 17px; font-weight: 700; line-height: 1.35; display: block;">{{ ep.title }}</a>
      <!-- Summary -->
      {% if ep.summary %}
        <div style="font-size: 14px; color: #555; line-height: 1.6; margin-top: 12px; padding: 0 2px;">{{ ep.summary | safe }}</div>
      {% endif %}
    </div>
    {% endfor %}
    {% if not podcasts %}<div style="font-size: 14px; color: #888; font-style: italic;">No new episodes this week.</div>{% endif %}
  </div>

  <!-- Divider -->
  <div style="padding: 0 28px;"><div style="height: 2px; background: linear-gradient(to right, #10b981, #6ee7b7, #10b981); border-radius: 2px;"></div></div>

  <!-- AI Security Papers -->
  <div style="padding: 28px 28px 24px 28px;">
    <div style="font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; color: #059669; margin: 0 0 20px 0;">&#128196; AI Security Papers</div>
    {% for paper in papers %}
    {% set title_lower = paper.title | lower %}
    <div style="background: #fff; border: 1px solid #eee; border-radius: 10px; padding: 20px; margin-bottom: 14px; border-left: 4px solid #10b981;">
      <!-- Date + Authors -->
      <div style="font-size: 12px; font-weight: 600; color: #047857; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px;">{{ paper.published }} &nbsp;&middot;&nbsp; {{ paper.authors[:3] | join(", ") }}{% if paper.authors | length > 3 %} et al.{% endif %}{% if paper.citation_count is not none and paper.citation_count %} &nbsp;&middot;&nbsp; {{ paper.citation_count }} citations{% endif %}</div>
      <!-- Title -->
      <a href="{{ paper.link }}" style="color: #1a1a2e; text-decoration: none; font-size: 17px; font-weight: 700; line-height: 1.35; display: block;">{{ paper.title }}</a>
      <!-- Topic badges -->
      {% set abstract_lower = (paper.abstract | default('')) | lower %}
      {% set text_lower = title_lower ~ ' ' ~ abstract_lower %}
      <div style="margin-top: 8px;">
        {% if 'prompt injection' in text_lower %}<span style="display: inline-block; background: #fee2e2; color: #991b1b; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">prompt injection</span>{% endif %}
        {% if 'jailbreak' in text_lower %}<span style="display: inline-block; background: #fce7f3; color: #9d174d; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">jailbreak</span>{% endif %}
        {% if 'model extraction' in text_lower or 'distillation attack' in text_lower %}<span style="display: inline-block; background: #fef3c7; color: #92400e; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">model extraction</span>{% endif %}
        {% if 'phishing' in text_lower or 'social engineering' in text_lower or 'clickfix' in text_lower %}<span style="display: inline-block; background: #fee2e2; color: #991b1b; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">social engineering</span>{% endif %}
        {% if 'malware' in text_lower or 'obfuscat' in text_lower %}<span style="display: inline-block; background: #1f2937; color: #f9fafb; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">malware</span>{% endif %}
        {% if 'agentic' in text_lower or 'autonomous agent' in text_lower %}<span style="display: inline-block; background: #e0e7ff; color: #3730a3; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">agentic AI</span>{% endif %}
        {% if 'llm-as-a-judge' in text_lower or 'agent-as-a-judge' in text_lower or 'llm as judge' in text_lower %}<span style="display: inline-block; background: #dbeafe; color: #1e40af; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">LLM-as-judge</span>{% endif %}
        {% if 'sycophancy' in text_lower or 'sabotage' in text_lower or 'behavioral evaluation' in text_lower %}<span style="display: inline-block; background: #f3e8ff; color: #6b21a8; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">behavioral eval</span>{% endif %}
        {% if 'privacy' in text_lower %}<span style="display: inline-block; background: #ccfbf1; color: #115e59; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">privacy</span>{% endif %}
        {% if 'red team' in text_lower %}<span style="display: inline-block; background: #fef3c7; color: #92400e; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">red teaming</span>{% endif %}
        {% if 'adversarial' in text_lower %}<span style="display: inline-block; background: #e0e7ff; color: #3730a3; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">adversarial</span>{% endif %}
        {% if 'safety' in text_lower or 'alignment' in text_lower %}<span style="display: inline-block; background: #d1fae5; color: #065f46; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">safety</span>{% endif %}
        {% if 'nist' in text_lower or 'taxonomy' in text_lower %}<span style="display: inline-block; background: #f1f5f9; color: #334155; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">NIST taxonomy</span>{% endif %}
        {% if 'guardrail' in text_lower %}<span style="display: inline-block; background: #f3e8ff; color: #6b21a8; font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; margin-right: 4px;">guardrail</span>{% endif %}
      </div>
      <!-- Summary -->
      {% set paper_summary = paper.quick_summary if paper.quick_summary else paper.abstract[:300] ~ ('...' if paper.abstract | length > 300 else '') %}
      <div style="font-size: 14px; color: #555; line-height: 1.6; margin-top: 12px; padding: 0 2px;">{{ paper_summary | safe }}</div>
    </div>
    {% endfor %}
    {% if not papers %}<div style="font-size: 14px; color: #888; font-style: italic;">No relevant papers found this week.</div>{% endif %}
  </div>

  <!-- Footer -->
  <div style="padding: 28px; text-align: center; font-size: 12px; color: #aaa; background: #fafafa; border-top: 1px solid #f0f0f0;">
    Generated automatically &middot; <a href="feed.xml" style="color: #6c63ff; text-decoration: none;">Subscribe via RSS</a>
  </div>

</div>
</body>
</html>
